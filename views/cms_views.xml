<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- FORM VIEW PRINCIPAL -->
    <record id="view_the_brand_page_form" model="ir.ui.view">
        <field name="name">the.brand.page.form</field>
        <field name="model">the.brand.page</field>
        <field name="arch" type="xml">
            <form string="The Brand CMS" create="0" delete="0">
                <sheet>
                    <div class="oe_title">
                        <h1>Brand Page Manager</h1>
                    </div>
                    
                    <notebook>
                        <!-- PESTAÑA 1: HERO -->
                        <page string="1. Hero Section" name="hero">
                            <group>
                                <group string="Identificadores">
                                    <field name="hero_number"/>
                                    <field name="hero_label"/>
                                </group>
                                <group string="Textos Principales">
                                    <field name="hero_title" placeholder="Ej: Curating the &lt;br&gt; Earth's Soul."/>
                                    <field name="hero_subtitle" placeholder="Ej: Earth's Soul."/>
                                </group>
                            </group>
                        </page>

                        <!-- PESTAÑA 2: MANIFIESTO -->
                        <page string="2. Manifesto" name="manifesto">
                            <group>
                                <field name="manifesto_title"/>
                                <field name="manifesto_text"/>
                            </group>
                        </page>

                        <!-- PESTAÑA 3: CAPÍTULOS (TIMELINE) -->
                        <page string="3. History Chapters" name="chapters">
                            <field name="chapter_ids">
                                <list string="Chapters" editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="year"/>
                                    <field name="title"/>
                                    <field name="media_type"/>
                                    
                                    <!-- Campos invisibles para nombres de archivo -->
                                    <field name="image_filename" column_invisible="True"/>
                                    <field name="video_filename" column_invisible="True"/>

                                    <!-- IMAGEN (Visible si media_type == image) -->
                                    <field name="image" 
                                           widget="binary" 
                                           filename="image_filename"
                                           options="{'accepted_file_extensions': '.png,.jpg,.jpeg,.webp'}"
                                           invisible="media_type != 'image'"/>
                                           
                                    <!-- VIDEO (Visible si media_type == video) -->
                                    <field name="video_file" 
                                           widget="binary" 
                                           filename="video_filename"
                                           options="{'accepted_file_extensions': '.mp4,.webm,.mov'}"
                                           string="Subir Video"
                                           invisible="media_type != 'video'"/>

                                    <field name="description"/>
                                </list>
                                
                                <!-- FORMULARIO EMERGENTE (Si abren el registro) -->
                                <form>
                                    <group>
                                        <group string="Información">
                                            <field name="year"/>
                                            <field name="title"/>
                                            <field name="subtitle"/>
                                            <field name="sequence"/>
                                        </group>
                                        <group string="Contenido Multimedia">
                                            <field name="media_type" widget="radio"/>
                                            
                                            <!-- Configuración Imagen -->
                                            <field name="image" 
                                                   widget="image" 
                                                   invisible="media_type != 'image'"/>
                                            <field name="image_src_manual" 
                                                   invisible="media_type != 'image'" 
                                                   placeholder="https://... (Opcional)"/>
                                            
                                            <!-- Configuración Video -->
                                            <field name="video_filename" invisible="1"/>
                                            <field name="video_file" 
                                                   widget="binary" 
                                                   filename="video_filename"
                                                   invisible="media_type != 'video'"/>
                                            <field name="video_url_manual" 
                                                   invisible="media_type != 'video'" 
                                                   placeholder="https://youtube.com/... (Opcional si no subes archivo)"/>
                                        </group>
                                        <group>
                                            <field name="description"/>
                                        </group>
                                    </group>
                                </form>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ACTION -->
    <record id="action_brand_page_config" model="ir.actions.act_window">
        <field name="name">Brand Configuration</field>
        <field name="res_model">the.brand.page</field>
        <field name="view_mode">form</field>
        <field name="res_id" ref="the_brand_cms.main_brand_page"/> 
    </record>

    <!-- MENU -->
    <menuitem id="menu_the_brand_root" name="THE BRAND" sequence="55"/>
    <menuitem id="menu_the_brand_cms" name="Configuration" parent="menu_the_brand_root" action="action_brand_page_config" sequence="1"/>

</odoo>